#ifndef _SELF_MODBUS_H_
#define _SELF_MODBUS_H_

//Modbus传输的PDU(协议数据单元)部分为big-Endian，且每个寄存器的大小为half-word

#define SELFMB_PDULEN_FUNCODE 1
#define SELFMB_PDULEN_STARTADDR 2
#define SELFMB_PDULEN_QUANTITYOFREG 2
#define SELFMB_PDULEN_BYTECOUNT 1

#define SELFMB_PDULEN_EXCEPFUNCODE 1
#define SELFMB_PDULEN_EXCEPCODE 1

#define SELFMB_EXCEPCODE_FUNFAULT 0x01
#define SELFMB_EXCEPCODE_QORFAULT 0x03
#define SELFMB_EXCEPCODE_ADDRFAULT 0x02
#define SELFMB_EXCEPCODE_CRCFAULT 0x05
#define SELFMB_EXCEPCODE_RMRFAULT 0x04
#define SELFMB_EXCEPCODE_WMRFAULT 0x04
#define SELFMB_EXCEPCODE_WRITDATAFAULT 0x06
#define SELFMB_EXCEPCODE_OVERFLOWFAULT 0x07 


#define SELFMB_FUNCODE_READHOLDREG 0x03
#define SELFMB_READHOLDREG_PDUREQLEN (SELFMB_PDULEN_FUNCODE+SELFMB_PDULEN_STARTADDR+SELFMB_PDULEN_QUANTITYOFREG)//Modbus 协议Read Holding Registers 功能请求帧PDU部分固定字节部分长度
#define SELFMB_READHOLDREG_PDURESLEN (SELFMB_PDULEN_FUNCODE+SELFMB_PDULEN_BYTECOUNT)//Modbus 协议Read Holding Registers 功能应答帧PDU部分固定字节部分长度(不包括数据字节)
#define SELFMB_READHOLDREG_REGADDRSTART 0x0020
#define SELFMB_READHOLDREG_HALFWORDREGLENMAX 20 //Modbus 协议Read Holding Registers 功能可操作最大half-word长度
#define SELFMB_READHOLDREG_REGADDREND (SELFMB_READHOLDREG_REGADDRSTART+SELFMB_READHOLDREG_HALFWORDREGLENMAX)
#define SELFMB_READHOLDREG_BYTEREGLENMAX (SELFMB_READHOLDREG_HALFWORDREGLENMAX * 2)//Modbus 协议Read Holding Registers 可操作最大byte长度
#define SELFMB_READHOLDREG_EXCEPQORMIN 0x0001
#define SELFMB_READHOLDREG_EXCEPQORMAX 0x007D



#define SELFMB_FUNCODE_WRITMULREG 0x10
#define SELFMB_WRITMULREG_PDUREQLEN (SELFMB_PDULEN_FUNCODE+SELFMB_PDULEN_STARTADDR+SELFMB_PDULEN_QUANTITYOFREG+SELFMB_PDULEN_BYTECOUNT)//Modbus 协议Write Multiple Registers 功能请求帧PDU部分固定字节部分长度(不包括数据字节)
#define SELFMB_WRITMULREG_PDURESLEN (SELFMB_PDULEN_FUNCODE+SELFMB_PDULEN_STARTADDR+SELFMB_PDULEN_QUANTITYOFREG)//Modbus 协议Write Multiple Registers 功能应答帧PDU部分固定字节部分长度
#define SELFMB_WRITMULREG_REGADDRSTART 0x0000
#define SELFMB_WRITMULREG_HALFWORDREGLENMAX 19 //Modbus 协议Write Multiple Registers 可操作最大half-word长度
#define SELFMB_WRITMULREG_REGADDREND (SELFMB_WRITMULREG_REGADDRSTART+SELFMB_WRITMULREG_HALFWORDREGLENMAX)
#define SELFMB_WRITMULREG_BYTEREGLENMAX (SELFMB_WRITMULREG_HALFWORDREGLENMAX * 2)//Modbus 协议Write Multiple Registers 可操作最大byte长度
#define SELFMB_WRITMULREG_EXCEPQORMIN 0x0001
#define SELFMB_WRITMULREG_EXCEPQORMAX 0x007B


#endif
